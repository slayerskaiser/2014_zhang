\documentclass[../zhang_thesis.tex]{subfiles}
\begin{document}

\chapter{Discussion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In terms of speed, for a given number of integration steps, the EKF is about 3 to 4 times faster than the SLF and 7 times faster than the UKF and CKF. Additionally, the time about doubles for each doubling in the number of integration steps. Note that the majority of the time is spend in performing the numerical integration, so the complexity of the discretization method directly affects the speed. The EKF has the simplest discretization so it is naturally the fastest. The SLF uses the
same method as the EKF but evaluates it multiple times per integration step, so it is somewhat slower. The UKF and CKF use a complex IT-1.5 discretization method that uses the Jacobians and Hessians of the system, so it is the slowest. Evaluation of the discretization at multiple sigma points further slows down these filters. Note that they are very fast for low numbers of integration steps, which can be explained by the filters encountering numerical problems with the Cholesky factorization
and skipping to the next trial.

In terms of the number of divergences, the EKF performs the best for $T_s=30$ seconds with some trials with good accuracy for $M=1$ and 2, followed by the CKF and SLF. The UKF performs the worst, with numerical problems for large $M$. The other three filters have good accuracy for $M\ge 4$. For $T_s=150$ seconds, the SLF has the lowest number of divergences, with good accuracy for $M\ge 8$, while the others need $M\ge 16$. The EKF is the second best with a few good trials at $M=4$ and 8.
The UKF and CKF tie for last place. For $T_s=300$ seconds, the CKF and SLF are the best with good accuracy for $M\ge 16$. The other two need $M\ge 32$, but EKF is slighly better than the UKF with less divergences at $M=16$. Overall, the SLF resulted in the best performance in terms of the number of divergences as a function of the number of integration steps. It achieved zero divergences at a equal or smaller number of integration steps for each of the sampling periods. The EKF and
CKF are close behind in performance. The EKF was able to get fewer than 100 divergences for $T_s=30$ and 150, where the CKF had 100 divergences. However, at $T_s=300$, the CKF achieves zero divergences at a smaller $M$ value. The worst performing filter was the UKF which had the highest number of divergences. In addition, it had some divergences for $T_s=30$ seconds for $M=128$ and 256, probably caused by numerical problems related to the unscented transform.

In terms of the MRMSE, for $T_s=30$ seconds, the EKF, CKf, and SLF are about equal in performance for $M\ge 4$, at which the divergences are zero. The MRMSE is flat in that range for those three filters. The best accuracy is achieved by the CKF at $M=32$. The UKF has poor performance at this sample rate and diverges for $M\ge 128$. For $T_s=150$ seconds, the SLF achieves the best performance for $M\le 8$, and the EKF has the worst performance. The CKF and UKF are about equal over the
range, with the UKF being significantly better at $M=1$. Larger values of $M$ shown increases in accuracy for all the filters, with the EKF achieving the best accuracy for $M\ge 16$. The CKF and SLF are about equal over the same range, while the UKF has the worst accuracy. For $T_s=300$ seconds, the SLF achieves the best accuracy for $M\le 16$, and the EKF has very poor performance. The CKF and UKF are about equal, with the CKF having a small edge in accuracy. For higher values of $M\ge
32$, the EKF achieves the best accuracy. The CKF and SLF are about equal over the range, and the UKF has the worst accuracy.

It can be seen that the trend of accuracy as a function of the number of integration steps is similar for sample period of 150 and 300 seconds, where the doubling in the number of integration steps at which no divergences are encountered from $T_s=150$ to 300 seconds is explained by the doubling of the sample period. The SLF has the best performance for a small number of integration steps, while the EKF has the best performance for greater than or equal to 16 and 32 integration steps for the sample
periods of 150 and 300, respectively. For a sample period of 30 seconds, the EKF, CKF, and SLF perform equally well for greater than or equal to 4 integration steps, while the UKF encounters numerical problems that cause it to diverge for greater than 64 integration steps.

Overall, the EKF has the best accuracy and the best speed, for sufficiently large numbers of integration steps. The speed is expected since it is the least complex of the studied filters. In addition, its poor performance at small numbers of integration steps is due to the nonlinearity of the system. However, its greater accuracy for large numbers of integration steps is surprising since the battery system is strongly nonlinear, particularly for SOC near zero. This effect could be
caused by a non-Gaussian posterior distribution of the noises, which would negatively impact the Gaussian assumption used by the other filters. The LMMSE Kalman filter does not make such an assumption to minimize the error covariance. In fact, Kalman showed that the linear estimate with non-Gaussian noise can only be improved by nonlinear estimation when at least third-order probability distribution functions are considered~\cite{kalman60}. As this was not the case with the chosen filters, it
makes sense that the EKF performs the best when a sufficiently large number of steps are used to minimize the error of the numerical integration.

\end{document}
